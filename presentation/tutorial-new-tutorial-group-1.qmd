---
title: "Few-Shot Learning for Rooftop Detection in Satellite Imagery"
subtitle: "Deep Learning Tutorial"
author: "Giorgio Coppola, Nadine Daum, Elena Dreyer, Nico Reichardt"
bibliography: refs.bib


resources:
  - img/**
  - figures/**

format:
  revealjs:
    theme: dimmery.scss
    slide-number: true
    default-image-width: 70%
    preview-links: auto
    logo: ""
    footer: ""
    transition: slide
    background-transition: fade
    self-contained: true
    html-math-method:
      method: mathjax
      url: https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js
    include-in-header: include.html
    resources:
      - img/**
---



## Problem Setting

::: columns
::: column
- Cities need accurate rooftop maps to plan and scale **solar PV installations**

- Manual rooftop labeling is **slow** and **costly**

- Every city looks different → traditional models do not **generalize** well

### Idea:

- **Few-shot learning** makes segmentation possible with only a handful of labeled examples

:::

::: column
![](figures/picture_use_case.png){width=90% style="margin-left: 30%;"}
:::
:::


## Dataset: [Rooftops of Geneva](https://huggingface.co/datasets/raphaelattias/overfitteam-geneva-satellite-images)

::: columns
::: column

- **Satellite Images**: High-resolution RGB satellite images of Geneva available on Huggingface
- **Size**: 1,050 labeled image-mask pairs
- **Task**: Binary segmentation masks (rooftop vs background)
- **Geographic splits**: 3 grids/ neighborhoods (1301_11, 1301_13, 1301_31)
- **Image size**: 250x250 pixels
- **Categories**: Industrial, Residential


:::

::: column
![](figures/grids_animation.gif){width=60% style="margin-left: 30%;"}
![](figures/Geneva_grid_map.png){width=82% style="margin-left: 30%;"}

:::
:::

## Few Shot Learning in General

### Few-Shot Learning (FSL)
- Learning new **tasks, labels, or segmentations** from very few labeled examples  
  *(N-way, K-shot)*  
  
- **Motivation**:
  - Data scarcity
  - Expensive and time-consuming annotation

### Few-Shot Semantic Segmentation (FSSS)
- **Goal**: Segment novel object classes using only a few annotated examples
- Assigning a class label to **every pixel**


---

## Prototypical Networks (ProtNets)

- Learn a shared **embedding space** via a backbone model
- Pixels belonging to the same class are **close in feature space**
- Class representations are formed as **prototypes**
- Training follows an **episodic framework**
- Each episode consists of:
  - **Support set**:  
    Few images with **pixel-level masks**  
    Defines the target classes
  - **Query image**:  
    Image where the model must segment the target classes

## Prototypical Network Overview

### Workflow
- Support Image → Prototype → Similarity → Query Segmentation


### Feature Extraction
- **Backbone:** ResNet-18 CNN, pretrained on ImageNet
- **Projection:** feature maps → embedding dimension (256 channels)


### Evaluation Metric
$$
\mathrm{IoU} = \frac{|A \cap B|}{|A \cup B|}
$$


---

## Prototypical Network Overview

::: {#fig-protnet fig-align="center"}
![](figures/illustration_prototypical_network.png){width=100%}

*(Modified figure from* [SRPNet](https://arxiv.org/abs/2210.16829)*)*
:::


---

## (Preliminary) Results 

**Meta training loss:**  
The “avg episode loss” at each epoch is the average cross-entropy error over all support–query tasks in that epoch. The encoder is successfully learning a feature space where prototype-based segmentation works increasingly well.

::: {#fig-meta-training fig-align="center"}
![](figures/meta_training_loss.png){width=50%}
:::
---

## (Preliminary) Results 
**Show predicted masks:**  
With 5-shot learning, the predicted masks have a mean IoU over 102 test samples of 0.485. Here an example:  

![](figures/predicted_mask.png){width=60% fig-align="center"}

## Wrap-Up/ Discussion

**What we still want to work on**:

- Testing different kind of pretrained models as our encoder (ResNet-50, ResNet pretrained on satellite images)

- Play around with different distance metrics (Cosine Similarity and Fidelity)

- Evaluate different K values and see how they perform


**Discussion and Key Takeaways**

- Strong 1-shot performance: even with minimal labeled data, results were impressive

- Dataset brought its own challenges (designed primarily for PV assessment, not general segmentation)

- Limited scope: focused only on roofs in Geneva → raises questions of generalizability

- More diverse data or complex models could improve performance


[GitHub Repo](https://github.com/hertie-data-science-lab/tutorial-new-tutorial-group-1/tree/main)







